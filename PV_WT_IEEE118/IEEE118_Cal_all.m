function [x_30, Cost, Ploss, VD, L_index] = IEEE118_Cal_all(x)
    data = case118;
    data.gen(:, 2) = x(1:54); % 发电机有功功率
    data.gen(:, 6) = x(55:108); % 发电机电压幅值
    data.branch(8, 9) = x(109); % 变压器分接头位置
    data.branch(32, 9) = x(110);
    data.branch(36, 9) = x(111);
    data.branch(61, 9) = x(112);
    data.branch(93, 9) = x(113);
    data.branch(95, 9) = x(114);
    data.branch(102, 9) = x(115);
    data.branch(107, 9) = x(116);
    data.branch(127, 9) = x(117);
    data.bus(34, 6) = x(118); % 并联电容无功补偿
    data.bus(44, 6) = x(119);
    data.bus(45, 6) = x(120);
    data.bus(46, 6) = x(121);
    data.bus(48, 6) = x(122);
    data.bus(74, 6) = x(123);
    data.bus(79, 6) = x(124);
    data.bus(82, 6) = x(125);
    data.bus(83, 6) = x(126);
    data.bus(105, 6) = x(127);
    data.bus(107, 6) = x(128);
    data.bus(110, 6) = x(129);
    opt = mpoption('VERBOSE', 0, 'OUT_ALL', 0);
    res = runpf(data, opt);
    Ploss = sum(res.branch(:, 14) + res.branch(:, 16)); % 网损
    Cost = 0;
    for i = 1:54
        P = res.gen(i, 2);
        Cost = Cost + res.gencost(i, 5) * P^2 + res.gencost(i, 6) * P;
    end
    V = res.bus(:, 8);
    VD = sum(abs(V - 1));
    x_30 = res.gen(30, 2);
    L_index = calculate_L_index_max(res);
end
